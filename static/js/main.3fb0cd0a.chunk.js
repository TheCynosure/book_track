(this.webpackJsonpbook_track=this.webpackJsonpbook_track||[]).push([[0],{43:function(t,e,n){},52:function(t,e,n){"use strict";n.r(e);var s=n(1),a=n(0),i=n.n(a),o=n(20),r=n.n(o),c=(n(43),n(44),n(7)),l=n(8),u=n(10),h=n(9),d=n(55),b=n(56),p=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).state={style:{opacity:1}},s}return Object(l.a)(n,[{key:"componentWillReceiveProps",value:function(t,e){var n=this;t.showBook!==this.props.showBook&&setTimeout((function(){return n.visibleStyle()}),10)}},{key:"visibleStyle",value:function(t){this.callback=t,this.setState({style:{opacity:1,transition:"all .2s ease"}})}},{key:"invisibleStyle",value:function(t){this.callback=t,this.setState({open:!1,style:{opacity:0,transition:"all .2s ease"}})}},{key:"transitionEnd",value:function(t){t.target.className.includes("IconHeader")&&this.execCallback()}},{key:"execCallback",value:function(){void 0!==this.callback&&this.callback()}},{key:"onClick",value:function(){var t=this;this.invisibleStyle((function(){t.props.onClick()}))}},{key:"render",value:function(){var t=this;return Object(s.jsx)(d.a,{className:"mt-5 mb-5 text-center",children:Object(s.jsx)("h1",{onTransitionEnd:function(e){return t.transitionEnd(e)},className:"IconHeader",style:this.state.style,children:Object(s.jsx)(b.a,{})})})}}]),n}(i.a.Component),j=n(14),f=n.n(j),k=n(25),x=n(57),v=n(58),O=n(67),m=n(37),y=n(70),g=n(69),w=n(64),B=n(62),C=n(63),S=n(59),N=n(68),T=n(60),M=n(61);function L(t){return Object(s.jsxs)(d.a,{className:"w-100 p-0",children:[Object(s.jsx)("hr",{}),Object(s.jsxs)(x.a,{className:"pt-3 pb-3 align-items-center",children:[Object(s.jsx)(v.a,{lg:3,md:3,sm:3,xs:12,className:"px-0 py-2",children:Object(s.jsxs)(S.a,{size:"sm",children:[Object(s.jsx)(S.a.Prepend,{children:Object(s.jsx)(S.a.Text,{children:"Page #"})}),Object(s.jsx)(N.a,{placeholder:t.current_page,onChange:function(e){return function(t,e){isNaN(Number(t.target.value))||(Number(t.target.value)>e.length&&(t.target.value=e.length),e.updateBook(Number(t.target.value),e.length))}(e,t)}})]})}),Object(s.jsx)(v.a,{lg:{span:4,offset:1},md:{span:4,offset:1},sm:{span:4,offset:1},xs:12,className:"px-0 py-2",children:Object(s.jsxs)(S.a,{size:"sm",children:[Object(s.jsx)(S.a.Prepend,{children:Object(s.jsx)(S.a.Text,{children:"Max Page #"})}),Object(s.jsx)(N.a,{placeholder:t.length,onChange:function(e){return function(t,e){isNaN(Number(t.target.value))||e.updateBook(e.current_page,Number(t.target.value))}(e,t)}})]})}),""===t.link?Object(s.jsx)(s.Fragment,{}):Object(s.jsx)(v.a,{className:"px-0 py-2 text-center",lg:{span:1,offset:0},md:{span:1,offset:0},sm:{span:1,offset:4},xs:{span:1,offset:0},children:Object(s.jsx)(y.a,{variant:"info",className:"btn-sm",href:t.link,onClick:function(e){e.preventDefault(),window.open(t.link)},children:Object(s.jsx)(T.a,{})})}),Object(s.jsx)(v.a,{className:"px-0 py-2 text-center",lg:{span:1,offset:""===t.link?3:2},md:{span:1,offset:""===t.link?3:2},sm:{span:1,offset:""===t.link?5:3},xs:{span:1,offset:9},children:Object(s.jsx)(y.a,{variant:"danger",className:"btn-sm",onClick:function(){return t.removeBook()},children:Object(s.jsx)(M.a,{})})})]})]})}var V=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).state={open:!1,show:!0,style:{opacity:0}},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this;setTimeout((function(){return t.visibleStyle()}),10)}},{key:"visibleStyle",value:function(){this.setState({style:{opacity:1,transition:"all .3s ease"}})}},{key:"invisibleStyle",value:function(t){this.callback=t,this.setState({open:!1,style:{opacity:0,transition:"all .3s ease"}})}},{key:"transitionEnd",value:function(t){t.target.className.includes("BookListAnimation")&&0===this.state.style.opacity&&this.setState({show:!1},this.execCallback)}},{key:"execCallback",value:function(){void 0!==this.callback&&this.callback()}},{key:"isComplete",value:function(){return this.props.book.current_page===this.props.book.length&&!this.state.open}},{key:"renderButton",value:function(){var t=this;return this.isComplete()?Object(s.jsx)(y.a,{variant:"success",className:"btn-sm",onClick:function(){return t.onClick()},disabled:this.props.disabled,children:Object(s.jsx)(B.a,{})}):Object(s.jsx)(y.a,{variant:this.state.open?"secondary":"primary",onClick:function(){return t.onClick()},"aria-controls":"book-config-collapse","aria-expanded":this.state.open,className:"btn-sm",disabled:this.props.disabled,children:Object(s.jsx)(C.a,{})})}},{key:"onClick",value:function(){var t=this;this.isComplete()?this.invisibleStyle((function(){return t.props.finishBook()})):this.setState({open:!this.state.open})}},{key:"render",value:function(){var t=this;return this.state.show&&Object(s.jsx)(O.a.Item,{style:this.state.style,onTransitionEnd:function(e){return t.transitionEnd(e)},className:"BookListAnimation",children:Object(s.jsxs)(d.a,{children:[Object(s.jsxs)(x.a,{className:"align-items-center",children:[Object(s.jsx)(v.a,{lg:4,sm:12,xs:12,className:"px-0 py-2",children:Object(s.jsx)("h4",{className:"mb-0",children:this.props.book.title})}),Object(s.jsx)(v.a,{lg:7,sm:12,xs:12,className:"px-0 py-2",children:Object(s.jsx)(g.a,{variant:this.props.book.current_page>=this.props.book.length?"success":"info",now:this.props.book.current_page/this.props.book.length*100,label:Math.floor(this.props.book.current_page/this.props.book.length*100)+"%",style:{width:"100%"},disabled:this.props.disabled})}),Object(s.jsx)(v.a,{lg:{span:1,offset:0},sm:{span:12,offset:0},xs:{span:12,offset:0},className:"py-2 text-center",children:this.renderButton()})]}),Object(s.jsx)(x.a,{children:Object(s.jsx)(v.a,{children:Object(s.jsx)(w.a,{in:this.state.open,children:Object(s.jsx)("div",{id:"book-config-collapse",children:Object(s.jsx)("div",{className:"pt-3 pb-3",children:Object(s.jsx)(L,Object(m.a)({updateBook:function(e,n){return t.props.updateBook(e,n)},removeBook:function(){return t.invisibleStyle((function(){return t.props.removeBook()}))}},this.props.book))})})})})})]})})}}]),n}(i.a.Component);function A(t){return Object(s.jsx)(d.a,{children:Object(s.jsx)(x.a,{children:Object(s.jsx)(v.a,{children:Object(s.jsx)(O.a,{children:t.books.map((function(e,n){return Object(s.jsx)(V,{book:e,updateBook:function(n,s){return t.updateBook(e.title)(n,s)},removeBook:function(){return t.removeBook(e.title)},finishBook:function(){return t.finishBook(e.title)},disabled:t.disabled},e.title)}))})})})})}var E=n(65),G=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(c.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var t=this;return Object(s.jsx)(d.a,{children:Object(s.jsx)(x.a,{className:"text-center",children:Object(s.jsx)(v.a,{children:Object(s.jsx)(y.a,{className:"mt-3 mb-3 btn-sm",onClick:function(){return t.props.handleNewBook()},children:Object(s.jsx)(E.a,{})})})})})}}]),n}(i.a.Component),I=n(66),P=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).state={title:"",length:1,isTitleInputValid:!1,isLengthInputValid:!1,possibleGBooks:[]},s}return Object(l.a)(n,[{key:"updatePossibleGBooks",value:function(t){var e=this;fetch("https://book-track-backend.herokuapp.com/gbooks/search/"+t).then((function(t){t.json().then((function(t){e.setState({possibleGBooks:t})})).catch((function(t){console.error(t),e.setState({possibleGBooks:[]})}))}))}},{key:"onTitleChange",value:function(t){null!==t.target.value&&0!==t.target.value.length&&this.props.checkValid(t.target.value)?(this.updatePossibleGBooks(t.target.value),this.setState({title:t.target.value,isTitleInputValid:!0})):this.setState({title:t.target.value,isTitleInputValid:!1})}},{key:"onMaxChange",value:function(t){isNaN(Number(t.target.value))||Number(t.target.value)<=0?this.setState({length:1,isLengthInputValid:!1}):this.setState({length:t.target.value,isLengthInputValid:!0})}},{key:"handleSubmit",value:function(){var t=this.state.title,e=this.state.length,n=this.hasExactGBookMatch()?"https://www.gutenberg.org/ebooks/"+this.getExactGBookMatches()[0].number:"";this.setState({title:"",length:1,isTitleInputValid:!1,isLengthInputValid:!1,possibleGBooks:[]}),this.props.onAdd({title:t,length:e,link:n})}},{key:"hasExactGBookMatch",value:function(){return this.getExactGBookMatches().length>=1}},{key:"getExactGBookMatches",value:function(){var t=this;return this.state.possibleGBooks.filter((function(e){return e.title===t.state.title}))}},{key:"render",value:function(){var t=this;return Object(s.jsxs)(I.a,{show:this.props.show,onHide:function(){return t.props.onCancel()},backdrop:"static",children:[Object(s.jsx)(I.a.Header,{closeButton:!0,children:Object(s.jsx)(I.a.Title,{children:"Add A Book"})}),Object(s.jsx)(I.a.Body,{children:Object(s.jsxs)(d.a,{children:[Object(s.jsx)(x.a,{className:"m-2",children:Object(s.jsx)(v.a,{children:Object(s.jsxs)(S.a,{children:[Object(s.jsx)(S.a.Prepend,{children:Object(s.jsx)(S.a.Text,{children:"Title"})}),Object(s.jsx)(N.a,{onChange:function(e){return t.onTitleChange(e)}}),Object(s.jsx)(S.a.Append,{children:Object(s.jsx)(S.a.Text,{children:Object(s.jsx)(T.a,{className:this.state.possibleGBooks.length>0?this.hasExactGBookMatch()?"text-success":"text-info":"text-secondary"})})})]})})}),Object(s.jsx)(x.a,{className:"m-2",children:Object(s.jsx)(v.a,{children:Object(s.jsxs)(S.a,{children:[Object(s.jsx)(S.a.Prepend,{children:Object(s.jsx)(S.a.Text,{children:"Max Page #"})}),Object(s.jsx)(N.a,{onChange:function(e){return t.onMaxChange(e)}})]})})})]})}),Object(s.jsxs)(I.a.Footer,{children:[Object(s.jsx)(y.a,{variant:"secondary",onClick:function(){return t.props.onCancel()},children:"Cancel"}),Object(s.jsx)(y.a,{variant:"primary",onClick:function(){return t.handleSubmit()},disabled:!(this.state.isTitleInputValid&&this.state.isLengthInputValid),children:"Add"})]})]})}}]),n}(i.a.Component),z=n(35),H=n.n(z),_=n(36),R=n.n(_);function q(t){var e=t.current,n=t.total;return 0===e&&0===n&&(n=1),Object(s.jsx)(d.a,{className:"w-100 mt-3 mb-3",children:Object(s.jsx)(g.a,{now:Math.floor(e/n*100),label:e+" / "+n})})}var J="https://book-track-backend.herokuapp.com/",D=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).state={books:[],history:[],showAddModal:!1,windowSize:{width:void 0,height:void 0},showConfetti:!1,isLoaded:!1},s}return Object(l.a)(n,[{key:"handleResize",value:function(){this.setState({windowSize:{width:window.innerWidth,height:window.innerHeight}})}},{key:"componentDidMount",value:function(){var t=this;window.addEventListener("resize",(function(){return t.handleResize()})),this.getAllBooks()}},{key:"componentWillUnmount",value:function(){var t=this;window.addEventListener("resize",(function(){return t.handleResize()}))}},{key:"getAllBooks",value:function(){var t=Object(k.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getBooks();case 2:return t.next=4,this.getBooks(!0);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getBooks",value:function(){var t=Object(k.a)(f.a.mark((function t(){var e,n,s=this,a=arguments;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=a.length>0&&void 0!==a[0]&&a[0],n=J+(e?"history":"books"),fetch(n).then((function(t){304===t.status?s.setState({isLoaded:!1}):t.json().then((function(t){e?s.setState({history:t,isLoaded:!0}):s.setState({books:t,isLoaded:!0})})).catch((function(t){console.log(t),s.setState({isLoaded:!0,error:t})}))}),(function(t){console.error(t),s.setState({isLoaded:!0,error:t})}));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"updateBook",value:function(t){var e=this;return function(){var n=Object(k.a)(f.a.mark((function n(s,a){var i,o,r,c,l;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.state.books.slice(),(o=i.find((function(e){return e.title===t}))).current_page=s,o.length=a,(r=new Headers).append("Content-Type","application/json"),c={method:"PUT",headers:r,body:JSON.stringify(o)},l=new Request(J+"books",c),n.next=10,fetch(l);case 10:if(200!==n.sent.status){n.next=15;break}return e.setState({isLoaded:!0}),n.next=15,e.getAllBooks();case 15:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()}},{key:"removeBook",value:function(){var t=Object(k.a)(f.a.mark((function t(e){var n,s,a,i,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setState({isLoaded:!1}),n=this.state.books.slice(),0!==(s=n.filter((function(t){return t.title===e}))).length){t.next=6;break}return console.error("No matching book for one deleted."),t.abrupt("return");case 6:return console.log(s[0].title),(a=new Headers).append("Content-Type","application/json"),i={method:"DELETE",headers:a,body:JSON.stringify(s[0])},o=new Request(J+"books",i),t.next=13,fetch(o);case 13:if(200!==t.sent.status){t.next=18;break}return this.setState({isLoaded:!0}),t.next=18,this.getAllBooks();case 18:return t.abrupt("return",s);case 19:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"finishBook",value:function(t){var e=this,n=this.state.books.filter((function(e){return e.title===t}))[0];this.removeBook(t).then((function(){e.spawnConfetti(),e.addBook(n,!0)}))}},{key:"promptNewBookModal",value:function(){this.setState({showAddModal:!0})}},{key:"addBook",value:function(){var t=Object(k.a)(f.a.mark((function t(e){var n,s,a,i,o,r=arguments;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]&&r[1],this.setState({isLoaded:!1}),e.current_page=n?e.length:0,(s=new Headers).append("Content-Type","application/json"),a={method:"POST",headers:s,body:JSON.stringify(e)},i=J+(n?"history":"books"),this.setState({showAddModal:!1}),o=new Request(i,a),t.next=11,fetch(o);case 11:if(200!==t.sent.status){t.next=16;break}return this.setState({isLoaded:!0}),t.next=16,this.getAllBooks();case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"spawnConfetti",value:function(){this.setState({showConfetti:!0})}},{key:"onConfettiComplete",value:function(t){this.setState({showConfetti:!1}),t.reset()}},{key:"isTitleUnique",value:function(t){return 0===this.state.books.filter((function(e){return e.title===t})).length}},{key:"renderBookHistory",value:function(){if(this.state.history.length>0)return Object(s.jsxs)(d.a,{className:"p-0",children:[Object(s.jsx)(x.a,{className:"p-0",children:Object(s.jsx)(v.a,{children:Object(s.jsx)(q,{current:this.state.history.length,total:this.state.history.length+this.state.books.length})})}),Object(s.jsx)(x.a,{className:"p-0",children:Object(s.jsx)(v.a,{children:Object(s.jsx)(A,{books:this.state.history,disabled:!0})})})]})}},{key:"renderMainScreen",value:function(){var t=this,e=this.state.windowSize.width,n=this.state.windowSize.height;return Object(s.jsxs)(d.a,{lg:8,md:8,sm:8,xs:12,children:[Object(s.jsx)(H.a,{width:e,height:n,recycle:!1,numberOfPieces:this.state.showConfetti?500:0,onConfettiComplete:function(e){return t.onConfettiComplete(e)}}),Object(s.jsx)(A,{books:this.state.books,updateBook:function(e){return t.updateBook(e)},removeBook:function(e){return t.removeBook(e)},finishBook:function(e){return t.finishBook(e)}}),Object(s.jsx)(G,{handleNewBook:function(){return t.promptNewBookModal()}}),this.renderBookHistory(),Object(s.jsx)(P,{show:this.state.showAddModal,onAdd:function(e){return t.addBook(e)},onCancel:function(){return t.setState({showAddModal:!1})},checkValid:function(e){return t.isTitleUnique(e)}})]})}},{key:"render",value:function(){return Object(s.jsx)(d.a,{children:this.renderMainScreen()})}}]),n}(i.a.Component),U=R()(D),W=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(c.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(s.jsx)(d.a,{fluid:!0})}}]),n}(i.a.Component),F=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).state={mainView:!0},s}return Object(l.a)(n,[{key:"switchViews",value:function(){this.setState({mainView:!this.state.mainView})}},{key:"render",value:function(){var t=this;return Object(s.jsxs)(d.a,{fluid:!0,style:{overflowY:"auto",overflowX:"hidden"},children:[Object(s.jsx)(p,{onClick:function(){return t.switchViews()},showBook:this.state.mainView}),this.state.mainView?Object(s.jsx)(U,{}):Object(s.jsx)(W,{})]})}}]),n}(i.a.Component);r.a.render(Object(s.jsx)(i.a.StrictMode,{children:Object(s.jsx)(F,{})}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.3fb0cd0a.chunk.js.map